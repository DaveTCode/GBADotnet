# Gameboy Advanced Emulator - C#

This is a WIP Gameboy Advanced emulator which is nowhere near something you'd want to play games actual roms.

- [Compatibility](./compatibility)
- [Notes](./Notes.md)

## Test Rom Status

| Group      | Test                     | Status             | Notes                                                                                                                                                                                                     |
|------------|--------------------------|--------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DenSinH    | Arm Data Processing      | :heavy_check_mark: |                                                                                                                                                                                                           |
| DenSinH    | Arm Any                  | :heavy_check_mark: |                                                                                                                                                                                                           |
| DenSinH    | Thumb Data Processing    | :heavy_check_mark: |                                                                                                                                                                                                           |
| DenSinH    | Thumb Any                | :heavy_check_mark: |                                                                                                                                                                                                           |
| Open bus   | Open Bus Bios Misaligned | :heavy_check_mark: | Implemented open bus for bios and passed this and jsmolka bios tests                                                                                                                                      |
| Marie      | Open Bus Bios            | :x:                | Fixed top 4, wrong with THM but so is mgba so not that big a deal                                                                                                                                         |
| Marie      | Retaddr                  | :heavy_check_mark: |                                                                                                                                                                                                           |
| Fleroviux  | Openbuster               | :x:                | 1/144 - smashed it (mostly because I haven't written a proper open bus rotate for LDRH)                                                                                                                   |
| Dead_Body  | cpu_test                 | :heavy_check_mark: | Passes after ensuring that the rotates on the data bus are handled for misaligned reads                                                                                                                   |
| Wrestler   | arm-wrestler-fixed       | :heavy_check_mark: | Mode 0 enabled this to run. Fixed all LDR/STR/LDM/STM operations now that shifter treats RRX properly and register writebacks happen on the correct cycle. FIQ banking support required for MRS/MSR tests |
| JSMolka    | arm                      | :heavy_check_mark: | Passes all tests now                                                                                                                                                                                      |
| JSMolka    | thumb                    | :heavy_check_mark: | Passes everything after some shenanigans with LDM/STM special cases                                                                                                                                       |
| JSMolka    | memory                   | :heavy_check_mark: | Passes all memory mirror tests after implementing mirroring of relevant regions                                                                                                                           |
| JSMolka    | nes                      | :heavy_check_mark: | Passed first time                                                                                                                                                                                         |
| JSMolka    | hello                    | :heavy_check_mark: |                                                                                                                                                                                                           |
| JSMolka    | shades                   | :heavy_check_mark: | Amusingly reads beyond the end of the provided ROM (w/ pipelining) so that needed fixing before it passed                                                                                                 |
| JSMolka    | stripes                  | :heavy_check_mark: |                                                                                                                                                                                                           |
| JSMolka    | bios                     | :heavy_check_mark: |                                                                                                                                                                                                           |
| JSMolka    | unsafe                   | :heavy_check_mark: | According to readme doesn't pass on real hardware so this is not a great test to be passing!                                                                                                              |
| Panda      | panda                    | :heavy_check_mark: |                                                                                                                                                                                                           |
| PeterLemon | 3DEngine                 | :heavy_check_mark: |                                                                                                                                                                                                           |
| PeterLemon | Hello World              | :heavy_check_mark: | Required SWI, DMA channel 3 immediate, transparent palette color 0 and multiple palettes in same BG                                                                                                       |
| PeterLemon | BGMode0                  | :heavy_check_mark: | Requires "BG Tile Offset = 0, Enable Mosaic, Tiles 8BPP, BG Map Offset = 26624, Map Size = 64x64 Tiles"                                                                                                   |
| PeterLemon | BGMode7                  | :heavy_check_mark: | Affine backgrounds                                                                                                                                                                                        |
| PeterLemon | BGRotZoomMode2           | :x:                | Working except unimplemented mosaic                                                                                                                                                                       |
| PeterLemon | BGRotZoomMode3           | :x:                | Displays but affine transforms not implemented for bitmap modes                                                                                                                                           |
| PeterLemon | BGRotZoomMode4           | :x:                | As with mode 3 above                                                                                                                                                                                      |
| PeterLemon | BGRotZoomMode5           | :x:                | As with mode 3 and 4 above                                                                                                                                                                                |
| PeterLemon | OBJRotZoom4BPP           | :heavy_check_mark: | 32*64 sprite is wrong, rest are correct                                                                                                                                                                   |
| PeterLemon | OBJRotZoom8BPP           | :heavy_check_mark: | 8bpp sprites fixes made this work (except mosaic which is tracked elsewhere)                                                                                                                              |
| PeterLemon | Fast Line                | :heavy_check_mark: | Ran on first attempt                                                                                                                                                                                      |
| PeterLemon | Fast Line Clip           | :heavy_check_mark: | Ran on first attempt                                                                                                                                                                                      |
| PeterLemon | Cylinder Map             | :heavy_check_mark: | Ran on first attempt, not clear what it showcases                                                                                                                                                         |
| PeterLemon | Myst                     | :heavy_check_mark: | Looks good to me although only let it play for 30s or so                                                                                                                                                  |
| PeterLemon | BigBuckBunny             | :?:                | Runs but only displays video in top left quadrant (scaled down from full size!), haven't checked if that's intentional                                                                                    |
| PeterLemon | BIOS - ArcTan            | :heavy_check_mark: | Passes after lots of work on timers                                                                                                                                                                       |
| PeterLemon | BIOS - Div               | :heavy_check_mark: | Passes after lots of work on timers                                                                                                                                                                       |
| PeterLemon | BIOS - Sqrt              | :heavy_check_mark: | Passes after lots of work on timers                                                                                                                                                                       |
| PeterLemon | Timers                   | :heavy_check_mark: | Passes after implementing timer register byte reads                                                                                                                                                       |
| mgba       | suite                    | :x:                | See Notes.md for detailed breakdown of pass/fail                                                                                                                                                          |
| TONC       | Bigmap                   | :heavy_check_mark: | Requires byte wide writes to PPU registers which isn't implemented                                                                                                                                        |
| TONC       | Blddemo                  | :heavy_check_mark: | Blending appears to work compared against mgba                                                                                                                                                            |
| TONC       | BM Modes                 | :heavy_check_mark: | Looks weird but tested against other emulators                                                                                                                                                            |
| TONC       | Brin Demo                | :heavy_check_mark: | Passes with proper support for multi size tilemaps                                                                                                                                                        |
| TONC       | CBB Demo                 | :x:                | Display not quite right, extra sprite missing in top left and two extra lines shown                                                                                                                       |
| TONC       | DMA Demo                 | :heavy_check_mark: | Interesting hackery using HBLANK DMA to create a round window effect                                                                                                                                      |
| TONC       | First                    | :heavy_check_mark: | First passing test case!                                                                                                                                                                                  |
| TONC       | Hello                    | :heavy_check_mark: | Calls an SWI from Thumb and then ends up executing beyond where it should in bios. Haven't checked what's happening precisely.                                                                            |
| TONC       | IRQ Demo                 | :heavy_check_mark: | Looking good, compared completely against mgba and correct                                                                                                                                                |
| TONC       | Key Demo                 | :heavy_check_mark: | Working first time it was tested                                                                                                                                                                          |
| TONC       | M3 Demo                  | :heavy_check_mark: |                                                                                                                                                                                                           |
| TONC       | M7 Demo                  | :heavy_check_mark: | Affine backgrounds working nicely but goes blank if I rotate the screen past half way (fixed by correctly using signed 16 bit ints)                                                                       |
| TONC       | M7 Demo MB               | :heavy_check_mark: | Requires affine backgrounds                                                                                                                                                                               |
| TONC       | M7 Demo Ex               | :x:                | Background isn't quite placed right and stretches as I rotate in certain directions. Umwat.                                                                                                               |
| TONC       | Mos Demo                 | :x:                | Requires mosaic                                                                                                                                                                                           |
| TONC       | OA Combo                 | :heavy_check_mark: | Sprites don't appear in quite the right place, affine sprites not quite right                                                                                                                             |
| TONC       | Obj Aff                  | :heavy_check_mark: | Good affine sprite test rom                                                                                                                                                                               |
| TONC       | Obj Demo                 | :heavy_check_mark: | I think this is working properly                                                                                                                                                                          |
| TONC       | Octtest                  | :heavy_check_mark: | Required affine backgrounds and sprites but now works                                                                                                                                                     |
| TONC       | Pageflip                 | :heavy_check_mark: | Requires LYC to behave vaguely sensibly and page flipping (obviously) so those are vaguely tested                                                                                                         |
| TONC       | Prio Demo                | :heavy_check_mark: |                                                                                                                                                                                                           |
| TONC       | Sbb Aff                  | :heavy_check_mark: | Requires affine background                                                                                                                                                                                |
| TONC       | Sbb Reg                  | :heavy_check_mark: | Requires large backgrounds                                                                                                                                                                                |
| TONC       | Second                   | :heavy_check_mark: | fixed with bug fixes around SWI return/MSR/MRS                                                                                                                                                            |
| TONC       | SWI Demo                 | :heavy_check_mark: | Required a really interesting interaction with PC and a load instruction which was bugged for ages                                                                                                        |
| TONC       | SWI VSync                | :heavy_check_mark: | Tests sprite rotations based on vsync in some way                                                                                                                                                         |
| TONC       | Tmr Demo                 | :heavy_check_mark: | Tests countdown timers by displaying as a clock, seems to work although I'm sure timer values aren't 100% correct                                                                                         |
| TONC       | TTE Demo                 | :x:                | Full test of all sorts of things                                                                                                                                                                          |
| TONC       | Txt Obj                  | :heavy_check_mark: | Letters bouncing properly, looks like sprite rendering working here well                                                                                                                                  |
| TONC       | Txt SE1                  | :heavy_check_mark: | Looks identical to mgba                                                                                                                                                                                   |
| TONC       | Txt SE2                  | :x:                | Some of these I'm quite close on timings and some I'm out by a chunk, not clear why that is but hopefully nothing serious!                                                                                |
| TONC       | Win demo                 | :heavy_check_mark: | Window implemented and working (but no OBJ window bits)                                                                                                                                                   |
| beeg       | beeg.gba                 | :heavy_check_mark: | With scanline renderer this is now fine                                                                                                                                                                   |
| AGB        | AGB_CHECKER_TCHK10       | :x:                | No longer hangs after fixing the vcount flag (was set to 1 forever afer set once) but fails many tests. Most worryingly the timer tests                                                                   |
| zayd       | prefetch abuse           | :x:                | All wrong values, still don't have a good handle on the prefetch module                                                                                                                                   |
| zayd       | dmaslow                  | :x:                | All wrong values, still don't have a good handle on the prefetch module                                                                                                                                   |
| zayd       | dmamedium                | :x:                | All wrong values, still don't have a good handle on the prefetch module                                                                                                                                   |
| zayd       | dmamedium2               | :x:                | All wrong values, still don't have a good handle on the prefetch module                                                                                                                                   |
| zayd       | dmafast                  | :x:                | All wrong values, still don't have a good handle on the prefetch module                                                                                                                                   |
| NBA        | IRQ Delay                | :x:                | Passes first but off by 2 cycles on HALT                                                                                                                                                                  |
| NBA        | DMA - Burst into tears   | :x:                |                                                                                                                                                                                                           |
| NBA        | DMA - Latch              | :heavy_check_mark: |                                                                                                                                                                                                           |
| NBA        | DMA - Start Delay        | :heavy_check_mark: | 20 on real GBA and 20 here, fixed by getting write cycles correct                                                                                                                                         |
| NBA        | Haltcnt                  | :x:                |                                                                                                                                                                                                           |
| NBA        | PPU - Basic Timing       | :heavy_check_mark: | HDMA doesn't bloody stop when HBlank turns off. FFS. Idiot.                                                                                                                                               |
| NBA        | Timer - Start Stop       | :heavy_check_mark: | Fixed by adding 1 cycle delay from register write to stopping timer                                                                                                                                       |
| NBA        | Timer - Reload           | :x:                | First 3 tests pass, last two don't and I'm not quite sure why.                                                                                                                                            |
